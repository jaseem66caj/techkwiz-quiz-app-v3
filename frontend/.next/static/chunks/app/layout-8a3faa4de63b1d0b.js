(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{210:(e,t,r)=>{"use strict";r.d(t,{$5:()=>a,Go:()=>g,HW:()=>l,R1:()=>u,iD:()=>s,ri:()=>i,z0:()=>h});let o={USER:"techkwiz_user",AUTH_TOKEN:"techkwiz_auth",SESSION_COINS:"techkwiz_session_coins"},n=(e,t)=>({id:"user_"+Math.random().toString(36).substr(2,9),email:e.toLowerCase(),name:e.split("@")[0].replace(/[^a-zA-Z0-9]/g," ").trim()||"Tech Enthusiast",coins:0,level:1,totalQuizzes:0,correctAnswers:0,joinDate:new Date().toISOString(),quizHistory:[]}),s=(e,t)=>{let r=d(e);if(r)return localStorage.setItem(o.AUTH_TOKEN,"dummy_token_"+r.id),r;{let r=n(e,t);return u(r),localStorage.setItem(o.AUTH_TOKEN,"dummy_token_"+r.id),r}},a=(e,t,r)=>{let s=n(e,t);return r&&(s.name=r),u(s),localStorage.setItem(o.AUTH_TOKEN,"dummy_token_"+s.id),s},i=()=>{localStorage.removeItem(o.AUTH_TOKEN)},c=(e,t)=>{try{let r=sessionStorage.getItem(o.SESSION_COINS),n=r?JSON.parse(r):{};n[e]=Math.max(0,t),sessionStorage.setItem(o.SESSION_COINS,JSON.stringify(n)),console.log("\uD83D\uDCB0 Session coins updated for ".concat(e,": ").concat(t))}catch(e){console.error("Error setting session coins:",e)}},l=()=>{let e=localStorage.getItem(o.AUTH_TOKEN);if(!e)return null;let t=e.replace("dummy_token_",""),r=m().find(e=>e.id===t);return r&&(r.coins=(e=>{try{let t=sessionStorage.getItem(o.SESSION_COINS);if(!t)return 0;return JSON.parse(t)[e]||0}catch(e){return console.error("Error getting session coins:",e),0}})(t)),r||null},u=e=>{let t=m(),r=t.findIndex(t=>t.id===e.id||t.email===e.email);c(e.id,e.coins);let n={...e,coins:0};r>=0?t[r]=n:t.push(n),localStorage.setItem(o.USER,JSON.stringify(t))},d=e=>m().find(t=>t.email===e.toLowerCase())||null,m=()=>{try{let e=localStorage.getItem(o.USER);return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing stored users:",e),[]}},h=(e,t)=>{c(e,t)},g=(e,t)=>{let r=m(),n=r.findIndex(t=>t.id===e);if(n>=0){r[n].quizHistory.push(t),r[n].totalQuizzes+=1,r[n].correctAnswers+=t.correctAnswers||0;let e=Math.floor(r[n].totalQuizzes/5)+1;r[n].level=e,localStorage.setItem(o.USER,JSON.stringify(r))}}},347:()=>{},881:(e,t,r)=>{"use strict";r.d(t,{b:()=>u,n:()=>d});var o=r(5155),n=r(2115),s=r(210),a=r(5431);let i={user:null,isAuthenticated:!1,currentQuiz:null,quizHistory:[],loading:!0},c=(0,n.createContext)(void 0);function l(e,t){switch(t.type){case"SET_LOADING":return{...e,loading:t.payload};case"LOGIN_SUCCESS":return{...e,user:t.payload,isAuthenticated:!0,loading:!1};case"LOGOUT":return{...e,user:null,isAuthenticated:!1,currentQuiz:null,quizHistory:[]};case"UPDATE_COINS":if(!e.user)return e;let r=e.user.coins,o=r+t.payload;o=Math.min(500,o=Math.max(0,o));let n={...e.user,coins:o};return(0,s.R1)(n),(0,s.z0)(n.id,o),console.log("\uD83D\uDCB0 COINS UPDATE: ".concat(r," + ").concat(t.payload," = ").concat(o)),{...e,user:n};case"START_QUIZ":return{...e,currentQuiz:t.payload};case"END_QUIZ":if(!e.user)return e;let a=t.payload,c={...e.user,totalQuizzes:e.user.totalQuizzes+1,correctAnswers:e.user.correctAnswers+a.correctAnswers},l=a.coinsEarned||0;c.coins=e.user.coins+l,console.log("\uD83C\uDF89 Quiz completed! Earned ".concat(l," coins (").concat(a.correctAnswers," correct \xd7 25)"));let u=Math.floor(c.totalQuizzes/5)+1;return c.level=u,(0,s.Go)(e.user.id,a),(0,s.R1)(c),(0,s.z0)(c.id,c.coins),{...e,user:c,currentQuiz:null,quizHistory:[...e.quizHistory,a]};case"RESET_USER":return{...e,user:i.user};default:return e}}function u(e){let{children:t}=e,[r,u]=(0,n.useReducer)(l,i);return(0,n.useEffect)(()=>{(async()=>{console.log("\uD83D\uDE80 Initializing auth with session-based coins...");try{let e=(0,s.HW)();e?(console.log("\uD83D\uDC64 Found user: ".concat(e.name," with ").concat(e.coins," session coins")),u({type:"LOGIN_SUCCESS",payload:e})):console.log("\uD83D\uDC64 No authenticated user found - will let page components handle guest creation and onboarding")}catch(e){console.error("Auth initialization error:",e),u({type:"SET_LOADING",payload:!1})}u({type:"SET_LOADING",payload:!1})})()},[]),(0,o.jsx)(c.Provider,{value:{state:r,dispatch:u},children:(0,o.jsx)(a.X,{children:t})})}function d(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useApp must be used within a Providers");return e}},2302:(e,t,r)=>{"use strict";async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.startsWith("http")?e:"".concat("").concat(e.startsWith("/")?"":"/").concat(e),o={method:"GET",headers:{"Content-Type":"application/json",...t.headers},signal:AbortSignal.timeout(1e4),...t};console.log("\uD83C\uDF10 API Request: ".concat(t.method||"GET"," ").concat(r));try{let e=await fetch(r,o);if(!e.ok)throw console.error("❌ API Error: ".concat(e.status," ").concat(e.statusText)),Error("HTTP ".concat(e.status,": ").concat(e.statusText));return console.log("✅ API Success: ".concat(t.method||"GET"," ").concat(r)),e}catch(e){throw console.error("❌ API Request Failed: ".concat(r),e),e}}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(await o(e,t)).json()}r.d(t,{AT:()=>o,cQ:()=>n})},5431:(e,t,r)=>{"use strict";r.d(t,{X:()=>i,z:()=>c});var o=r(5155),n=r(2115),s=r(2302);let a=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[c,l]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=localStorage.getItem("admin_token"),t=localStorage.getItem("admin_username");e&&t?(console.log("\uD83D\uDD04 Found stored credentials, setting admin user immediately"),i({username:t,token:e}),u(e,t).catch(console.error)):l(!1)},[]);let u=async(e,t)=>{try{console.log("\uD83D\uDD10 Verifying admin token for:",t),(await (0,s.AT)("/api/admin/verify",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})).ok?console.log("✅ Admin token verified successfully"):(console.log("❌ Admin token verification failed"),localStorage.removeItem("admin_token"),localStorage.removeItem("admin_username"),i(null)),l(!1)}catch(e){console.error("❌ Admin token verification error:",e),localStorage.removeItem("admin_token"),localStorage.removeItem("admin_username"),i(null),l(!1)}},d=async(e,t)=>{try{console.log("\uD83D\uDD0D Admin login attempt:",e);let r=(await (0,s.cQ)("/api/admin/login",{method:"POST",body:JSON.stringify({username:e,password:t})})).access_token;return console.log("✅ Admin login successful, token received"),localStorage.setItem("admin_token",r),localStorage.setItem("admin_username",e),i({username:e,token:r}),!0}catch(e){return console.error("❌ Admin login error:",e),!1}};return(0,o.jsx)(a.Provider,{value:{adminUser:r,isAuthenticated:!!r,login:d,logout:()=>{localStorage.removeItem("admin_token"),localStorage.removeItem("admin_username"),i(null)},loading:c},children:t})}let c=()=>{let e=(0,n.useContext)(a);if(void 0===e)throw Error("useAdmin must be used within an AdminProvider");return e}},5695:(e,t,r)=>{"use strict";var o=r(8999);r.o(o,"usePathname")&&r.d(t,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}}),r.o(o,"useSearchParams")&&r.d(t,{useSearchParams:function(){return o.useSearchParams}})},6903:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var o=r(5155),n=r(8346),s=r.n(n),a=r(881);r(347);var i=r(5695);function c(e){let{children:t}=e;return(0,o.jsx)("html",{lang:"en",children:(0,o.jsx)("body",{className:s().className,children:(0,o.jsx)(a.b,{children:(0,o.jsx)(l,{children:t})})})})}function l(e){let{children:t}=e,r=(0,i.usePathname)();return(null==r?void 0:r.startsWith("/admin"))?(0,o.jsx)("div",{style:{width:"100vw",minHeight:"100vh",margin:0,padding:0},children:t}):(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900",children:(0,o.jsx)("div",{className:"mx-auto max-w-sm sm:max-w-sm md:max-w-sm lg:max-w-sm xl:max-w-sm 2xl:max-w-sm min-h-screen bg-gray-900/50 backdrop-blur-sm border-x border-white/10",children:t})})}},8346:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}},9886:(e,t,r)=>{Promise.resolve().then(r.bind(r,6903))}},e=>{e.O(0,[838,441,964,358],()=>e(e.s=9886)),_N_E=e.O()}]);