(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{760:(e,t,s)=>{"use strict";s.d(t,{N:()=>b});var a=s(5155),i=s(2115),r=s(869),n=s(2885),l=s(7494),o=s(845),c=s(7351),d=s(1508);class m extends i.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,c.s)(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:s,anchorX:r,root:n}=e,l=(0,i.useId)(),o=(0,i.useRef)(null),c=(0,i.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=(0,i.useContext)(d.Q);return(0,i.useInsertionEffect)(()=>{let{width:e,height:t,top:a,left:i,right:d}=c.current;if(s||!o.current||!e||!t)return;o.current.dataset.motionPopId=l;let m=document.createElement("style");u&&(m.nonce=u);let x=null!=n?n:document.head;return x.appendChild(m),m.sheet&&m.sheet.insertRule('\n          [data-motion-pop-id="'.concat(l,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===r?"left: ".concat(i):"right: ".concat(d),"px !important;\n            top: ").concat(a,"px !important;\n          }\n        ")),()=>{x.contains(m)&&x.removeChild(m)}},[s]),(0,a.jsx)(m,{isPresent:s,childRef:o,sizeRef:c,children:i.cloneElement(t,{ref:o})})}let x=e=>{let{children:t,initial:s,isPresent:r,onExitComplete:l,custom:c,presenceAffectsLayout:d,mode:m,anchorX:x,root:g}=e,h=(0,n.M)(p),f=(0,i.useId)(),b=!0,y=(0,i.useMemo)(()=>(b=!1,{id:f,initial:s,isPresent:r,custom:c,onExitComplete:e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;l&&l()},register:e=>(h.set(e,!1),()=>h.delete(e))}),[r,h,l]);return d&&b&&(y={...y}),(0,i.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[r]),i.useEffect(()=>{r||h.size||!l||l()},[r]),"popLayout"===m&&(t=(0,a.jsx)(u,{isPresent:r,anchorX:x,root:g,children:t})),(0,a.jsx)(o.t.Provider,{value:y,children:t})};function p(){return new Map}var g=s(2082);let h=e=>e.key||"";function f(e){let t=[];return i.Children.forEach(e,e=>{(0,i.isValidElement)(e)&&t.push(e)}),t}let b=e=>{let{children:t,custom:s,initial:o=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:m="sync",propagate:u=!1,anchorX:p="left",root:b}=e,[y,j]=(0,g.xQ)(u),v=(0,i.useMemo)(()=>f(t),[t]),N=u&&!y?[]:v.map(h),w=(0,i.useRef)(!0),C=(0,i.useRef)(v),k=(0,n.M)(()=>new Map),[_,D]=(0,i.useState)(v),[S,P]=(0,i.useState)(v);(0,l.E)(()=>{w.current=!1,C.current=v;for(let e=0;e<S.length;e++){let t=h(S[e]);N.includes(t)?k.delete(t):!0!==k.get(t)&&k.set(t,!1)}},[S,N.length,N.join("-")]);let A=[];if(v!==_){let e=[...v];for(let t=0;t<S.length;t++){let s=S[t],a=h(s);N.includes(a)||(e.splice(t,0,s),A.push(s))}return"wait"===m&&A.length&&(e=A),P(f(e)),D(v),null}let{forceRender:X}=(0,i.useContext)(r.L);return(0,a.jsx)(a.Fragment,{children:S.map(e=>{let t=h(e),i=(!u||!!y)&&(v===S||N.includes(t));return(0,a.jsx)(x,{isPresent:i,initial:(!w.current||!!o)&&void 0,custom:s,presenceAffectsLayout:d,mode:m,root:b,onExitComplete:i?void 0:()=>{if(!k.has(t))return;k.set(t,!0);let e=!0;k.forEach(t=>{t||(e=!1)}),e&&(null==X||X(),P(C.current),u&&(null==j||j()),c&&c())},anchorX:p,children:e},t)})})}},2710:(e,t,s)=>{Promise.resolve().then(s.bind(s,9759))},5431:(e,t,s)=>{"use strict";s.d(t,{X:()=>n,z:()=>l});var a=s(5155),i=s(2115);let r=(0,i.createContext)(void 0);function n(e){let{children:t}=e,[s,n]=(0,i.useState)(null),[l,o]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=localStorage.getItem("admin_token"),t=localStorage.getItem("admin_username");e&&t?(console.log("\uD83D\uDD04 Found stored credentials, setting admin user immediately"),n({username:t,token:e}),c(e,t).catch(console.error)):o(!1)},[]);let c=async(e,t)=>{try{console.log("\uD83D\uDD10 Verifying token for:",t);let s="https://978348f0-0d46-419d-a947-ead723510d24.preview.emergentagent.com","/api/admin/profile"),{method:"PUT",headers:{Authorization:"Bearer ".concat(null==e?void 0:e.token),"Content-Type":"application/json"},body:JSON.stringify(t)});if(s.ok)o(!0),u({...m,currentPassword:"",newPassword:"",confirmPassword:""}),m.newPassword&&setTimeout(()=>{alert("Password updated successfully! Please log in again."),window.location.href="/admin"},2e3);else{let e=await s.json();d(e.detail||"Failed to update profile")}}catch(e){console.error("Failed to update profile:",e),d("Failed to update profile. Please try again.")}finally{s(!1)}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Profile Settings"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your admin account details and security"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[(0,a.jsxs)("form",{onSubmit:x,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),(0,a.jsx)("input",{type:"text",value:m.username,onChange:e=>u({...m,username:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),(0,a.jsx)("input",{type:"email",value:m.email,onChange:e=>u({...m,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password *"}),(0,a.jsx)("input",{type:"password",value:m.currentPassword,onChange:e=>u({...m,currentPassword:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Required to save any changes",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password (Optional)"}),(0,a.jsx)("input",{type:"password",value:m.newPassword,onChange:e=>u({...m,newPassword:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Leave empty to keep current",minLength:8})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),(0,a.jsx)("input",{type:"password",value:m.confirmPassword,onChange:e=>u({...m,confirmPassword:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Confirm new password",minLength:8})]})]})]})]}),c&&(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:c}),l&&(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-green-50 border border-green-200 rounded-lg p-4 text-green-800",children:"Profile updated successfully!"}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{u({username:(null==e?void 0:e.username)||"",email:"jaseem@adops.in",currentPassword:"",newPassword:"",confirmPassword:""}),d(""),o(!1)},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Reset Form"}),(0,a.jsx)(n.P.button,{type:"submit",disabled:t,whileHover:{scale:1.02},whileTap:{scale:.98},className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:t?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Changes"})]})]}),(0,a.jsxs)("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"\uD83D\uDD12 Security Information"}),(0,a.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[(0,a.jsx)("p",{children:"• Only you have access to the admin dashboard"}),(0,a.jsx)("p",{children:"• Sessions expire automatically for security"}),(0,a.jsx)("p",{children:"• Password changes require re-authentication"}),(0,a.jsx)("p",{children:"• Email changes affect password reset functionality"})]})]})]})]})}function g(){let{adminUser:e,logout:t,loading:s}=(0,r.z)(),[l,g]=(0,i.useState)("quizzes");return((0,i.useEffect)(()=>{let t=setTimeout(()=>{s||e||(console.log("\uD83D\uDD04 Dashboard: Redirecting to login - no admin user found"),window.location.href="/admin")},1e3);return()=>clearTimeout(t)},[e,s]),s)?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-600 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading admin dashboard..."})]}):e?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"w-full px-2",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-20",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"TechKwiz Admin"}),(0,a.jsxs)("span",{className:"ml-6 text-base text-gray-600 bg-gray-100 px-4 py-2 rounded-full",children:["Welcome, ",e.username]})]}),(0,a.jsx)("button",{onClick:t,className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg transition-colors font-medium text-base",children:"Logout"})]})})}),(0,a.jsx)("div",{className:"w-full px-2 py-2",children:(0,a.jsxs)("div",{className:"flex gap-4 h-full",children:[(0,a.jsx)("div",{className:"w-80 flex-shrink-0",children:(0,a.jsx)("nav",{className:"space-y-3",children:[{id:"quizzes",name:"Quiz Management",icon:"\uD83D\uDCDD"},{id:"site-config",name:"Site Configuration",icon:"⚙️"},{id:"scripts",name:"Scripts & Tracking",icon:"\uD83D\uDCCA"},{id:"ads",name:"Ad Management",icon:"\uD83D\uDCB0"},{id:"rewards",name:"Rewarded Popups",icon:"\uD83C\uDF81"},{id:"export",name:"Data Export",icon:"\uD83D\uDCBE"},{id:"profile",name:"Profile Settings",icon:"\uD83D\uDC64"}].map(e=>(0,a.jsxs)(n.P.button,{onClick:()=>g(e.id),whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full flex items-center px-6 py-4 text-left rounded-xl transition-all text-base ".concat(l===e.id?"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg":"bg-white text-gray-700 hover:bg-purple-50 hover:text-purple-700 shadow-sm border border-gray-100"),children:[(0,a.jsx)("span",{className:"text-2xl mr-4",children:e.icon}),(0,a.jsx)("span",{className:"font-semibold",children:e.name})]},e.id))})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-2xl shadow-lg p-4 min-h-[800px] border border-gray-100 w-full",children:(()=>{switch(l){case"quizzes":default:return(0,a.jsx)(o,{});case"site-config":return(0,a.jsx)(d,{});case"scripts":return(0,a.jsx)(c,{});case"ads":return(0,a.jsx)(m,{});case"rewards":return(0,a.jsx)(u,{});case"export":return(0,a.jsx)(x,{});case"profile":return(0,a.jsx)(p,{})}})()},l)})]})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Authenticating..."})]})}}},e=>{e.O(0,[463,441,964,358],()=>e(e.s=2710)),_N_E=e.O()}]);