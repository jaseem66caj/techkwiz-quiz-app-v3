(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{210:(e,t,o)=>{"use strict";o.d(t,{$5:()=>i,Go:()=>S,HW:()=>c,R1:()=>u,iD:()=>s,ri:()=>a,z0:()=>g});let r={USER:"techkwiz_user",AUTH_TOKEN:"techkwiz_auth",SESSION_COINS:"techkwiz_session_coins"},n=(e,t)=>({id:"user_"+Math.random().toString(36).substr(2,9),email:e.toLowerCase(),name:e.split("@")[0].replace(/[^a-zA-Z0-9]/g," ").trim()||"Tech Enthusiast",coins:0,level:1,totalQuizzes:0,correctAnswers:0,joinDate:new Date().toISOString(),quizHistory:[]}),s=(e,t)=>{let o=d(e);if(o)return localStorage.setItem(r.AUTH_TOKEN,"dummy_token_"+o.id),o;{let o=n(e,t);return u(o),localStorage.setItem(r.AUTH_TOKEN,"dummy_token_"+o.id),o}},i=(e,t,o)=>{let s=n(e,t);return o&&(s.name=o),u(s),localStorage.setItem(r.AUTH_TOKEN,"dummy_token_"+s.id),s},a=()=>{localStorage.removeItem(r.AUTH_TOKEN)},l=(e,t)=>{try{let o=sessionStorage.getItem(r.SESSION_COINS),n=o?JSON.parse(o):{};n[e]=Math.max(0,t),sessionStorage.setItem(r.SESSION_COINS,JSON.stringify(n)),console.log("\uD83D\uDCB0 Session coins updated for ".concat(e,": ").concat(t))}catch(e){console.error("Error setting session coins:",e)}},c=()=>{let e=localStorage.getItem(r.AUTH_TOKEN);if(!e)return null;let t=e.replace("dummy_token_",""),o=m().find(e=>e.id===t);return o&&(o.coins=(e=>{try{let t=sessionStorage.getItem(r.SESSION_COINS);if(!t)return 0;return JSON.parse(t)[e]||0}catch(e){return console.error("Error getting session coins:",e),0}})(t)),o||null},u=e=>{let t=m(),o=t.findIndex(t=>t.id===e.id||t.email===e.email);l(e.id,e.coins);let n={...e,coins:0};o>=0?t[o]=n:t.push(n),localStorage.setItem(r.USER,JSON.stringify(t))},d=e=>m().find(t=>t.email===e.toLowerCase())||null,m=()=>{try{let e=localStorage.getItem(r.USER);return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing stored users:",e),[]}},g=(e,t)=>{l(e,t)},S=(e,t)=>{let o=m(),n=o.findIndex(t=>t.id===e);if(n>=0){o[n].quizHistory.push(t),o[n].totalQuizzes+=1,o[n].correctAnswers+=t.correctAnswers||0;let e=Math.floor(o[n].totalQuizzes/5)+1;o[n].level=e,localStorage.setItem(r.USER,JSON.stringify(o))}}},347:()=>{},881:(e,t,o)=>{"use strict";o.d(t,{b:()=>u,n:()=>d});var r=o(5155),n=o(2115),s=o(210),i=o(5431);let a={user:null,isAuthenticated:!1,currentQuiz:null,quizHistory:[],loading:!0},l=(0,n.createContext)(void 0);function c(e,t){switch(t.type){case"SET_LOADING":return{...e,loading:t.payload};case"LOGIN_SUCCESS":return{...e,user:t.payload,isAuthenticated:!0,loading:!1};case"LOGOUT":return{...e,user:null,isAuthenticated:!1,currentQuiz:null,quizHistory:[]};case"UPDATE_COINS":if(!e.user)return e;let o=e.user.coins,r=o+t.payload;r=Math.min(500,r=Math.max(0,r));let n={...e.user,coins:r};return(0,s.R1)(n),(0,s.z0)(n.id,r),console.log("\uD83D\uDCB0 COINS UPDATE: ".concat(o," + ").concat(t.payload," = ").concat(r)),{...e,user:n};case"START_QUIZ":return{...e,currentQuiz:t.payload};case"END_QUIZ":if(!e.user)return e;let i=t.payload,l={...e.user,totalQuizzes:e.user.totalQuizzes+1,correctAnswers:e.user.correctAnswers+i.correctAnswers},c=i.coinsEarned||0;l.coins=e.user.coins+c,console.log("\uD83C\uDF89 Quiz completed! Earned ".concat(c," coins (").concat(i.correctAnswers," correct \xd7 25)"));let u=Math.floor(l.totalQuizzes/5)+1;return l.level=u,(0,s.Go)(e.user.id,i),(0,s.R1)(l),(0,s.z0)(l.id,l.coins),{...e,user:l,currentQuiz:null,quizHistory:[...e.quizHistory,i]};case"RESET_USER":return{...e,user:a.user};default:return e}}function u(e){let{children:t}=e,[o,u]=(0,n.useReducer)(c,a);return(0,n.useEffect)(()=>{(async()=>{console.log("\uD83D\uDE80 Initializing auth with session-based coins...");try{let e=(0,s.HW)();if(e)console.log("\uD83D\uDC64 Found user: ".concat(e.name," with ").concat(e.coins," session coins")),u({type:"LOGIN_SUCCESS",payload:e});else{console.log("\uD83D\uDC64 No authenticated user found - creating guest user");let e={id:"guest_".concat(Date.now()),name:"Guest User",email:"guest_".concat(Date.now(),"@techkwiz.com"),coins:0,level:1,totalQuizzes:0,correctAnswers:0,joinDate:new Date().toISOString(),quizHistory:[],achievements:[]};localStorage.setItem("techkwiz_auth","dummy_token_"+e.id);let t=JSON.parse(localStorage.getItem("techkwiz_user")||"[]");t.push(e),localStorage.setItem("techkwiz_user",JSON.stringify(t)),u({type:"LOGIN_SUCCESS",payload:e})}}catch(e){console.error("Auth initialization error:",e),u({type:"SET_LOADING",payload:!1})}u({type:"SET_LOADING",payload:!1})})()},[]),(0,r.jsx)(l.Provider,{value:{state:o,dispatch:u},children:(0,r.jsx)(i.X,{children:t})})}function d(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useApp must be used within a Providers");return e}},5431:(e,t,o)=>{"use strict";o.d(t,{X:()=>i,z:()=>a});var r=o(5155),n=o(2115);let s=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[o,i]=(0,n.useState)(null),[a,l]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=localStorage.getItem("admin_token"),t=localStorage.getItem("admin_username");e&&t?(console.log("\uD83D\uDD04 Found stored credentials, setting admin user immediately"),i({username:t,token:e}),c(e,t).catch(console.error)):l(!1)},[]);let c=async(e,t)=>{try{console.log("\uD83D\uDD10 Verifying token for:",t);let o="https://978348f0-0d46-419d-a947-ead723510d24.preview.emergentagent.com";console.log("\uD83C\uDF10 Using backend URL for verification:",o);let r=await fetch("".concat(o,"/api/admin/verify"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(console.log("\uD83D\uDD0D Verify response status:",r.status),r.ok){let o=await r.json();console.log("✅ Token verified successfully:",o),i({username:t,token:e})}else console.log("❌ Token verification failed, clearing storage"),localStorage.removeItem("admin_token"),localStorage.removeItem("admin_username"),i(null)}catch(e){console.error("❌ Token verification error:",e),console.log("⚠️ Network error during verification, keeping token for now")}finally{l(!1)}},u=async(e,t)=>{try{console.log("\uD83D\uDD0D Admin login attempt:",e);let o="https://978348f0-0d46-419d-a947-ead723510d24.preview.emergentagent.com";console.log("\uD83C\uDF10 Using backend URL:",o);let r=await fetch("".concat(o,"/api/admin/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(console.log("\uD83D\uDCE1 Login response status:",r.status),r.ok){let t=(await r.json()).access_token;return console.log("✅ Login successful, token received"),localStorage.setItem("admin_token",t),localStorage.setItem("admin_username",e),i({username:e,token:t}),!0}{let e=await r.json().catch(()=>({}));console.error("❌ Login failed:",r.status,e)}return!1}catch(e){return console.error("❌ Login error:",e),!1}};return(0,r.jsx)(s.Provider,{value:{adminUser:o,isAuthenticated:!!o,login:u,logout:()=>{localStorage.removeItem("admin_token"),localStorage.removeItem("admin_username"),i(null)},loading:a},children:t})}let a=()=>{let e=(0,n.useContext)(s);if(void 0===e)throw Error("useAdmin must be used within an AdminProvider");return e}},6903:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>a});var r=o(5155),n=o(8346),s=o.n(n),i=o(881);function a(e){let{children:t}=e;return(0,r.jsx)("html",{lang:"en",children:(0,r.jsx)("body",{className:s().className,style:{margin:0,padding:0,width:"100vw",overflowX:"hidden"},children:(0,r.jsx)(i.b,{children:(0,r.jsx)("div",{style:{width:"100vw",minHeight:"100vh",margin:0,padding:0},children:t})})})})}o(347)},8346:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}},9886:(e,t,o)=>{Promise.resolve().then(o.bind(o,6903))}},e=>{e.O(0,[838,441,964,358],()=>e(e.s=9886)),_N_E=e.O()}]);